'''EQUIVALENCE: Given ASCII, return a regex that matches each
   alphabetic letter as a bracket expression allowing for characters
   which are "equivalent". E.g., 'e' -> '[e√®ƒó√™ƒì√©]'.

   The purpose is to make it easy to to do to search for "epee" and
   match "√©p√©e".

   This is a poorman's POSIX "Equivalence Class", hardcoded to a
   sampling taken in late 2025 of the POSIX 'en_US.UTF-8' locale.
   POSIX regular expressions allow "[=x=]" in a bracket expression to
   match the sequence of characters of all collating elements
   equivalent to (and including) "x".

   Usage:
       from equivalence import equivalence
       re.search( equivalence('canape'), words )
'''


class EquivalenceClass:
    '''A class to hold the lookup table for quickly replacing letters
    with a regular expression character class that encompasses all the
    possible accented versions of that letter. E.g., n -> [n√±].'''

    table = {}
    table['A']=table['a']="[Aa¬™√Ä√Å√Ç√É√Ñ√Ö√†√°√¢√£√§√•ƒÄƒÅƒÇƒÉƒÑƒÖ«ç«é«û«ü«†«°«∫«ª»Ä»Å»Ç»É»¶»ß·¥¨·µÉ·∏Ä·∏Å·∫†·∫°·∫¢·∫£·∫§·∫•·∫¶·∫ß·∫®·∫©·∫™·∫´·∫¨·∫≠·∫Æ·∫Ø·∫∞·∫±·∫≤·∫≥·∫¥·∫µ·∫∂·∫∑‚Çê‚Ñ´‚íú‚í∂‚ìêÍûöÍûõÔº°ÔΩÅùêÄùêöùê¥ùëéùë®ùíÇùíúùí∂ùìêùì™ùîÑùîûùî∏ùïíùï¨ùñÜùñ†ùñ∫ùóîùóÆùòàùò¢ùòºùôñùô∞ùöäüÑêüÑ∞üÖêüÖ∞]"
    table['B']=table['b']="[Bb·¥Æ·µá·∏Ç·∏É·∏Ñ·∏Ö·∏Ü·∏á‚Ñ¨‚íù‚í∑‚ìëÔº¢ÔΩÇùêÅùêõùêµùëèùë©ùíÉùí∑ùìëùì´ùîÖùîüùîπùïìùï≠ùñáùñ°ùñªùóïùóØùòâùò£ùòΩùôóùô±ùöãüÑëüÑ±üÖëüÖ±]"
    table['C']=table['c']="[Cc√á√ßƒÜƒáƒàƒâƒäƒãƒåƒç·∂ú·∏à·∏â‚ÑÇ‚ÑÉ‚Ñ≠‚Ö≠‚ÖΩ‚íû‚í∏‚ìíÔº£ÔΩÉùêÇùêúùê∂ùëêùë™ùíÑùíûùí∏ùìíùì¨ùî†ùïîùïÆùñàùñ¢ùñºùóñùó∞ùòäùò§ùòæùôòùô≤ùöåüÑíüÑ´üÑ≤üÖíüÖ≤]"
    table['D']=table['d']="[Dd√ê√∞ƒéƒèƒêƒë·¥∞·µà·∂û·∏ä·∏ã·∏å·∏ç·∏é·∏è·∏ê·∏ë·∏í·∏ì‚ÖÖ‚ÖÜ‚ÖÆ‚Öæ‚íü‚íπ‚ììÍùπÍù∫Ôº§ÔΩÑùêÉùêùùê∑ùëëùë´ùíÖùíüùíπùììùì≠ùîáùî°ùîªùïïùïØùñâùñ£ùñΩùóóùó±ùòãùò•ùòøùôôùô≥ùöçüÑìüÑ≥üÖìüÖ≥üÜ•]"
    table['E']=table['e']="[Ee√à√â√ä√ã√®√©√™√´ƒíƒìƒîƒïƒñƒóƒòƒôƒöƒõ»Ñ»Ö»Ü»á»®»©·¥±·µâ·∏î·∏ï·∏ñ·∏ó·∏ò·∏ô·∏ö·∏õ·∏ú·∏ù·∫∏·∫π·∫∫·∫ª·∫º·∫Ω·∫æ·∫ø·ªÄ·ªÅ·ªÇ·ªÉ·ªÑ·ªÖ·ªÜ·ªá‚Çë‚ÑØ‚Ñ∞‚Öá‚í†‚í∫‚ìîÔº•ÔΩÖùêÑùêûùê∏ùëíùë¨ùíÜùìîùìÆùîàùî¢ùîºùïñùï∞ùñäùñ§ùñæùóòùó≤ùòåùò¶ùôÄùôöùô¥ùöéüÑîüÑ¥üÖîüÖ¥]"
    table['F']=table['f']="[Ff·∂†·∏û·∏ü‚Ñâ‚Ñ±‚í°‚íª‚ìïÍùªÍùºÔº¶ÔΩÜùêÖùêüùêπùëìùë≠ùíáùíªùìïùìØùîâùî£ùîΩùïóùï±ùñãùñ•ùñøùóôùó≥ùòçùòßùôÅùôõùôµùöèüÑïüÑµüÖïüÖµ]"
    table['G']=table['g']="[Ggƒúƒùƒûƒüƒ†ƒ°ƒ¢ƒ£«¶«ß«¥«µ·¥≥·µç·µπ·∏†·∏°‚Ñä‚í¢‚íº‚ìñÍùΩÍû†Íû°ÔºßÔΩáùêÜùê†ùê∫ùëîùëÆùíàùí¢ùìñùì∞ùîäùî§ùîæùïòùï≤ùñåùñ¶ùóÄùóöùó¥ùòéùò®ùôÇùôúùô∂ùöêüÑñüÑ∂üÖñüÖ∂]"
    table['H']=table['h']="[Hhƒ§ƒ•ƒ¶ƒß»û»ü ∞·¥¥·∏¢·∏£·∏§·∏•·∏¶·∏ß·∏®·∏©·∏™·∏´·∫ñ‚Çï‚Ñã‚Ñå‚Ñç‚Ñé‚Ñè‚í£‚íΩ‚ìóÍü∏Ôº®ÔΩàùêáùê°ùêªùëØùíâùíΩùìóùì±ùî•ùïôùï≥ùñçùñßùóÅùóõùóµùòèùò©ùôÉùôùùô∑ùöëüÑóüÑ∑üÖóüÖ∑]"
    table['I']=table['i']="[Ii√å√ç√é√è√¨√≠√Æ√Øƒ®ƒ©ƒ™ƒ´ƒ¨ƒ≠ƒÆƒØƒ∞«è«ê»à»â»ä»ã·¥µ·µ¢·∏¨·∏≠·∏Æ·∏Ø·ªà·ªâ·ªä·ªã‚Å±‚Ñê‚Ñë‚Ñπ‚Öà‚Ö†‚Ö∞‚í§‚íæ‚ìòÔº©ÔΩâùêàùê¢ùêºùëñùë∞ùíäùíæùìòùì≤ùî¶ùïÄùïöùï¥ùñéùñ®ùóÇùóúùó∂ùòêùò™ùôÑùôûùô∏ùöíüÑòüÑ∏üÖòüÖ∏]"
    table['J']=table['j']="[Jjƒ¥ƒµ«∞ ≤·¥∂‚Öâ‚í•‚íø‚ìô‚±ºÔº™ÔΩäùêâùê£ùêΩùëóùë±ùíãùí•ùíøùìôùì≥ùîçùîßùïÅùïõùïµùñèùñ©ùóÉùóùùó∑ùòëùò´ùôÖùôüùôπùöìüÑôüÑπüÖôüÖπ]"
    table['K']=table['k']="[Kkƒ∂ƒ∑«®«©·¥∑·µè·∏∞·∏±·∏≤·∏≥·∏¥·∏µ‚Çñ‚Ñ™‚í¶‚ìÄ‚ìöÍû¢Íû£Ôº´ÔΩãùêäùê§ùêæùëòùë≤ùíåùí¶ùìÄùìöùì¥ùîéùî®ùïÇùïúùï∂ùñêùñ™ùóÑùóûùó∏ùòíùò¨ùôÜùô†ùô∫ùöîüÑöüÑ∫üÖöüÖ∫]"
    table['L']=table['l']="[Llƒπƒ∫ƒªƒºƒΩƒæƒø≈Ä≈Å≈ÇÀ°·¥∏·∏∂·∏∑·∏∏·∏π·∏∫·∏ª·∏º·∏Ω‚Çó‚Ñí‚Ñì‚Ö¨‚Öº‚íß‚ìÅ‚ìõÔº¨ÔΩåùêãùê•ùêøùëôùë≥ùíçùìÅùìõùìµùîèùî©ùïÉùïùùï∑ùñëùñ´ùóÖùóüùóπùòìùò≠ùôáùô°ùôªùöïüÑõüÑªüÖõüÖª]"
    table['M']=table['m']="[Mm·¥π·µê·∏æ·∏ø·πÄ·πÅ·πÇ·πÉ‚Çò‚Ñ≥‚ÖØ‚Öø‚í®‚ìÇ‚ìúÔº≠ÔΩçùêåùê¶ùëÄùëöùë¥ùíéùìÇùìúùì∂ùîêùî™ùïÑùïûùï∏ùñíùñ¨ùóÜùó†ùó∫ùòîùòÆùôàùô¢ùôºùöñüÑúüÑºüÖúüÖº]"
    table['N']=table['n']="[Nn√ë√±≈É≈Ñ≈Ö≈Ü≈á≈à«∏«π·¥∫·πÑ·πÖ·πÜ·πá·πà·πâ·πä·πã‚Åø‚Çô‚Ñï‚í©‚ìÉ‚ìùÍû§Íû•ÔºÆÔΩéùêçùêßùëÅùëõùëµùíèùí©ùìÉùìùùì∑ùîëùî´ùïüùïπùñìùñ≠ùóáùó°ùóªùòïùòØùôâùô£ùôΩùöóüÑùüÑΩüÖùüÖΩ]"
    table['O']=table['o']="[Oo¬∫√í√ì√î√ï√ñ√ò√≤√≥√¥√µ√∂√∏≈å≈ç≈é≈è≈ê≈ë∆†∆°«ë«í«™«´«¨«≠«æ«ø»å»ç»é»è»™»´»¨»≠»Æ»Ø»∞»±·¥º·µí·πå·πç·πé·πè·πê·πë·πí·πì·ªå·ªç·ªé·ªè·ªê·ªë·ªí·ªì·ªî·ªï·ªñ·ªó·ªò·ªô·ªö·ªõ·ªú·ªù·ªû·ªü·ª†·ª°·ª¢·ª£‚Çí‚Ñ¥‚í™‚ìÑ‚ìûÍûúÍûùÔºØÔΩèùêéùê®ùëÇùëúùë∂ùíêùí™ùìûùì∏ùîíùî¨ùïÜùï†ùï∫ùñîùñÆùóàùó¢ùóºùòñùò∞ùôäùô§ùôæùöòüÑûüÑæüÖûüÖæ]"
    table['P']=table['p']="[Pp·¥æ·µñ·πî·πï·πñ·πó‚Çö‚Ñô‚í´‚ìÖ‚ìüÔº∞ÔΩêùêèùê©ùëÉùëùùë∑ùíëùí´ùìÖùìüùìπùîìùî≠ùï°ùïªùñïùñØùóâùó£ùóΩùòóùò±ùôãùô•ùôøùöôüÑüüÑøüÖüüÖøüÜä]"
    table['Q']=table['q']="[Qq‚Ñö‚í¨‚ìÜ‚ì†Ôº±ÔΩëùêêùê™ùëÑùëûùë∏ùííùí¨ùìÜùì†ùì∫ùîîùîÆùï¢ùïºùññùñ∞ùóäùó§ùóæùòòùò≤ùôåùô¶ùöÄùööüÑ†üÖÄüÖ†üÜÄ]"
    table['R']=table['r']="[Rr≈î≈ï≈ñ≈ó≈ò≈ô»ê»ë»í»ì ≥·¥ø·µ£·πò·πô·πö·πõ·πú·πù·πû·πü‚Ñõ‚Ñú‚Ñù‚í≠‚ìá‚ì°ÍûÇÍûÉÍû¶ÍûßÔº≤ÔΩíùêëùê´ùëÖùëüùëπùíìùìáùì°ùìªùîØùï£ùïΩùñóùñ±ùóãùó•ùóøùòôùò≥ùôçùôßùöÅùöõüÑ°üÑ¨üÖÅüÖ°üÜÅ]"
    table['S']=table['s']="[Ss≈ö≈õ≈ú≈ù≈û≈ü≈†≈°≈ø»ò»ôÀ¢·π†·π°·π¢·π£·π§·π•·π¶·πß·π®·π©·∫õ‚Çõ‚íÆ‚ìà‚ì¢ÍûÑÍûÖÍû®Íû©Ôº≥ÔΩìùêíùê¨ùëÜùë†ùë∫ùíîùíÆùìàùì¢ùìºùîñùî∞ùïäùï§ùïæùñòùñ≤ùóåùó¶ùòÄùòöùò¥ùôéùô®ùöÇùöúüÑ¢üÑ™üÖÇüÖ¢üÜÇ]"
    table['T']=table['t']="[Tt≈¢≈£≈§≈•»ö»õ·µÄ·µó·π™·π´·π¨·π≠·πÆ·πØ·π∞·π±·∫ó‚Çú‚íØ‚ìâ‚ì£ÍûÜÍûáÔº¥ÔΩîùêìùê≠ùëáùë°ùëªùíïùíØùìâùì£ùìΩùîóùî±ùïãùï•ùïøùñôùñ≥ùóçùóßùòÅùòõùòµùôèùô©ùöÉùöùüÑ£üÖÉüÖ£üÜÉ]"
    table['U']=table['u']="[Uu√ô√ö√õ√ú√π√∫√ª√º≈®≈©≈™≈´≈¨≈≠≈Æ≈Ø≈∞≈±≈≤≈≥∆Ø∆∞«ì«î«ï«ñ«ó«ò«ô«ö«õ«ú»î»ï»ñ»ó·µÅ·µò·µ§·π≤·π≥·π¥·πµ·π∂·π∑·π∏·ππ·π∫·πª·ª§·ª•·ª¶·ªß·ª®·ª©·ª™·ª´·ª¨·ª≠·ªÆ·ªØ·ª∞·ª±‚í∞‚ìä‚ì§ÍûûÍûüÔºµÔΩïùêîùêÆùëàùë¢ùëºùíñùí∞ùìäùì§ùìæùîòùî≤ùïåùï¶ùñÄùñöùñ¥ùóéùó®ùòÇùòúùò∂ùôêùô™ùöÑùöûüÑ§üÖÑüÖ§üÜÑ]"
    table['V']=table['v']="[Vv·µõ·µ•·πº·πΩ·πæ·πø‚Ö§‚Ö¥‚í±‚ìã‚ì•‚±ΩÔº∂ÔΩñùêïùêØùëâùë£ùëΩùíóùí±ùìãùì•ùìøùîôùî≥ùïçùïßùñÅùñõùñµùóèùó©ùòÉùòùùò∑ùôëùô´ùöÖùöüüÑ•üÖÖüÖ•üÜÖ]"
    table['W']=table['w']="[Ww≈¥≈µ ∑·µÇ·∫Ä·∫Å·∫Ç·∫É·∫Ñ·∫Ö·∫Ü·∫á·∫à·∫â·∫ò‚í≤‚ìå‚ì¶Ôº∑ÔΩóùêñùê∞ùëäùë§ùëæùíòùí≤ùìåùì¶ùîÄùîöùî¥ùïéùï®ùñÇùñúùñ∂ùóêùó™ùòÑùòûùò∏ùôíùô¨ùöÜùö†üÑ¶üÖÜüÖ¶üÜÜ]"
    table['X']=table['x']="[XxÀ£·∫ä·∫ã·∫å·∫ç‚Çì‚Ö©‚Öπ‚í≥‚ìç‚ìßÔº∏ÔΩòùêóùê±ùëãùë•ùëøùíôùí≥ùìçùìßùîÅùîõùîµùïèùï©ùñÉùñùùñ∑ùóëùó´ùòÖùòüùòπùôìùô≠ùöáùö°üÑßüÖáüÖßüÜá]"
    table['Y']=table['y']="[Yy√ù√Ω√ø≈∂≈∑≈∏»≤»≥ ∏·∫é·∫è·∫ô·ª≤·ª≥·ª¥·ªµ·ª∂·ª∑·ª∏·ªπ‚í¥‚ìé‚ì®ÔºπÔΩôùêòùê≤ùëåùë¶ùíÄùíöùí¥ùìéùì®ùîÇùîúùî∂ùïêùï™ùñÑùñûùñ∏ùóíùó¨ùòÜùò†ùò∫ùôîùôÆùöàùö¢üÑ®üÖàüÖ®üÜà]"
    table['Z']=table['z']="[Zz≈π≈∫≈ª≈º≈Ω≈æ·∂ª·∫ê·∫ë·∫í·∫ì·∫î·∫ï‚Ñ§‚Ñ®‚íµ‚ìè‚ì©Ôº∫ÔΩöùêôùê≥ùëçùëßùíÅùíõùíµùìèùì©ùîÉùî∑ùï´ùñÖùñüùñπùóìùó≠ùòáùò°ùòªùôïùôØùöâùö£üÑ©üÖâüÖ©üÜâ]"

    def __init__(self):
        return None

    def __getitem__(self, item):
        if item in self.table:
            return self.table[item];
        else:
            return item;

def equivalence(string: str):
    '''Given an ASCII string, return a regex replacing each letter
    with a bracket expression matching all equivalent characters in
    Unicode. For example, 'n' -> '[n√±]'.
    '''
    ec = EquivalenceClass();
    return ''.join([ ec[k] for k in string ])
